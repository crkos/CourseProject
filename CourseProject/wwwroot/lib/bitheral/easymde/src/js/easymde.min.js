/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@bitheral/easymde@2.19.1/src/js/easymde.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var CodeMirror=require("codemirror");require("codemirror/addon/edit/continuelist.js"),require("./codemirror/tablist"),require("codemirror/addon/display/fullscreen.js"),require("codemirror/mode/markdown/markdown.js"),require("codemirror/addon/mode/overlay.js"),require("codemirror/addon/display/placeholder.js"),require("codemirror/addon/display/autorefresh.js"),require("codemirror/addon/selection/mark-selection.js"),require("codemirror/addon/search/searchcursor.js"),require("codemirror/mode/gfm/gfm.js"),require("codemirror/mode/xml/xml.js");var CodeMirrorSpellChecker=require("codemirror-spell-checker"),marked=require("marked").marked,isMac=/Mac/.test(navigator.platform),anchorToExternalRegex=new RegExp(/(<a.*?https?:\/\/.*?[^a]>)+?/g),bindings={toggleBold:toggleBold,toggleItalic:toggleItalic,drawLink:drawLink,toggleHeadingSmaller:toggleHeadingSmaller,toggleHeadingBigger:toggleHeadingBigger,drawImage:drawImage,toggleBlockquote:toggleBlockquote,toggleOrderedList:toggleOrderedList,toggleUnorderedList:toggleUnorderedList,toggleCodeBlock:toggleCodeBlock,togglePreview:togglePreview,toggleStrikethrough:toggleStrikethrough,toggleHeading1:toggleHeading1,toggleHeading2:toggleHeading2,toggleHeading3:toggleHeading3,toggleHeading4:toggleHeading4,toggleHeading5:toggleHeading5,toggleHeading6:toggleHeading6,cleanBlock:cleanBlock,drawTable:drawTable,drawHorizontalRule:drawHorizontalRule,undo:undo,redo:redo,toggleSideBySide:toggleSideBySide,toggleFullScreen:toggleFullScreen},shortcuts={toggleBold:"Cmd-B",toggleItalic:"Cmd-I",drawLink:"Cmd-K",toggleHeadingSmaller:"Cmd-H",toggleHeadingBigger:"Shift-Cmd-H",toggleHeading1:"Ctrl+Alt+1",toggleHeading2:"Ctrl+Alt+2",toggleHeading3:"Ctrl+Alt+3",toggleHeading4:"Ctrl+Alt+4",toggleHeading5:"Ctrl+Alt+5",toggleHeading6:"Ctrl+Alt+6",cleanBlock:"Cmd-E",drawImage:"Cmd-Alt-I",toggleBlockquote:"Cmd-'",toggleOrderedList:"Cmd-Alt-L",toggleUnorderedList:"Cmd-L",toggleCodeBlock:"Cmd-Alt-C",togglePreview:"Cmd-P",toggleSideBySide:"F9",toggleFullScreen:"F11"},getBindingName=function(e){for(var t in bindings)if(bindings[t]===e)return t;return null},isMobile=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e.substr(0,4)))&&(t=!0),t};function addAnchorTargetBlank(e){for(var t;null!==(t=anchorToExternalRegex.exec(e));){var i=t[0];if(-1===i.indexOf("target=")){var o=i.replace(/>$/,' target="_blank">');e=e.replace(i,o)}}return e}function removeListStyleWhenCheckbox(e){for(var t=(new DOMParser).parseFromString(e,"text/html"),i=t.getElementsByTagName("li"),o=0;o<i.length;o++)for(var a=i[o],n=0;n<a.children.length;n++){var r=a.children[n];r instanceof HTMLInputElement&&"checkbox"===r.type&&(a.style.marginLeft="-1.5em",a.style.listStyleType="none")}return t.documentElement.innerHTML}function fixShortcut(e){return e=isMac?e.replace("Ctrl","Cmd"):e.replace("Cmd","Ctrl")}function createToolbarDropdown(e,t,i,o){var a=createToolbarButton(e,!1,t,i,"button",o);a.classList.add("easymde-dropdown"),a.onclick=function(){a.focus()};var n=document.createElement("div");n.className="easymde-dropdown-content";for(var r=0;r<e.children.length;r++){var l,s=e.children[r];(l=createToolbarButton("string"==typeof s&&s in toolbarBuiltInButtons?toolbarBuiltInButtons[s]:s,!0,t,i,"button",o)).addEventListener("click",(function(e){e.stopPropagation()}),!1),n.appendChild(l)}return a.appendChild(n),a}function createToolbarButton(e,t,i,o,a,n){e=e||{};var r=document.createElement(a);if(e.attributes)for(var l in e.attributes)Object.prototype.hasOwnProperty.call(e.attributes,l)&&r.setAttribute(l,e.attributes[l]);var s=n.options.toolbarButtonClassPrefix?n.options.toolbarButtonClassPrefix+"-":"";r.className=s+e.name,r.setAttribute("type",a),i=null==i||i,e.text&&(r.innerText=e.text),e.name&&e.name in o&&(bindings[e.name]=e.action),e.title&&i&&(r.title=createTooltip(e.title,e.action,o),isMac&&(r.title=r.title.replace("Ctrl","⌘"),r.title=r.title.replace("Alt","⌥"))),e.title&&r.setAttribute("aria-label",e.title),e.noDisable&&r.classList.add("no-disable"),e.noMobile&&r.classList.add("no-mobile");var d=[];void 0!==e.className&&(d=e.className.split(" "));for(var g=[],c=0;c<d.length;c++){var u=d[c];u.match(/^fa([srlb]|(-[\w-]*)|$)/)?g.push(u):r.classList.add(u)}if(r.tabIndex=-1,g.length>0){for(var p=document.createElement("i"),m=0;m<g.length;m++){var h=g[m];p.classList.add(h)}r.appendChild(p)}return void 0!==e.icon&&(r.innerHTML=e.icon),e.action&&t&&("function"==typeof e.action?r.onclick=function(t){t.preventDefault(),e.action(n)}:"string"==typeof e.action&&(r.onclick=function(t){t.preventDefault(),window.open(e.action,"_blank")})),r}function createSep(){var e=document.createElement("i");return e.className="separator",e.innerHTML="|",e}function createTooltip(e,t,i){var o,a=e;return t&&i[o=getBindingName(t)]&&(a+=" ("+fixShortcut(i[o])+")"),a}function getState(e,t){t=t||e.getCursor("start");var i=e.getTokenAt(t);if(!i.type)return{};for(var o,a,n=i.type.split(" "),r={},l=0;l<n.length;l++)"strong"===(o=n[l])?r.bold=!0:"variable-2"===o?(a=e.getLine(t.line),/^\s*\d+\.\s/.test(a)?r["ordered-list"]=!0:r["unordered-list"]=!0):"atom"===o?r.quote=!0:"em"===o?r.italic=!0:"quote"===o?r.quote=!0:"strikethrough"===o?r.strikethrough=!0:"comment"===o?r.code=!0:"link"!==o||r.image?"image"===o?r.image=!0:o.match(/^header(-[1-6])?$/)&&(r[o.replace("header","heading")]=!0):r.link=!0;return r}var saved_overflow="";function toggleFullScreen(e){var t=e.codemirror;t.setOption("fullScreen",!t.getOption("fullScreen")),t.getOption("fullScreen")?(saved_overflow=document.body.style.overflow,document.body.style.overflow="hidden"):document.body.style.overflow=saved_overflow;var i=t.getWrapperElement(),o=i.nextSibling;if(o.classList.contains("editor-preview-active-side"))if(!1===e.options.sideBySideFullscreen){var a=i.parentNode;t.getOption("fullScreen")?a.classList.remove("sided--no-fullscreen"):a.classList.add("sided--no-fullscreen")}else toggleSideBySide(e);(e.options.onToggleFullScreen&&e.options.onToggleFullScreen(t.getOption("fullScreen")||!1),void 0!==e.options.maxHeight&&(t.getOption("fullScreen")?(t.getScrollerElement().style.removeProperty("height"),o.style.removeProperty("height")):(t.getScrollerElement().style.height=e.options.maxHeight,e.setPreviewMaxHeight())),e.toolbar_div.classList.toggle("fullscreen"),e.toolbarElements&&e.toolbarElements.fullscreen)&&e.toolbarElements.fullscreen.classList.toggle("active")}function toggleBold(e){_toggleBlock(e,"bold",e.options.blockStyles.bold)}function toggleItalic(e){_toggleBlock(e,"italic",e.options.blockStyles.italic)}function toggleStrikethrough(e){_toggleBlock(e,"strikethrough","~~")}function toggleCodeBlock(e){var t=e.options.blockStyles.code;function i(e){if("object"!=typeof e)throw"fencing_line() takes a 'line' object (not a line number, or line text).  Got: "+typeof e+": "+e;return e.styles&&e.styles[2]&&-1!==e.styles[2].indexOf("formatting-code-block")}function o(e){return e.state.base.base||e.state.base}function a(e,t,a,n,r){a=a||e.getLineHandle(t),n=n||e.getTokenAt({line:t,ch:1}),r=r||!!a.text&&e.getTokenAt({line:t,ch:a.text.length-1});var l=n.type?n.type.split(" "):[];return r&&o(r).indentedCode?"indented":-1!==l.indexOf("comment")&&(o(n).fencedChars||o(r).fencedChars||i(a)?"fenced":"single")}var n,r,l,s=e.codemirror,d=s.getCursor("start"),g=s.getCursor("end"),c=s.getTokenAt({line:d.line,ch:d.ch||1}),u=s.getLineHandle(d.line),p=a(s,d.line,u,c);if("single"===p){var m=u.text.slice(0,d.ch).replace("`",""),h=u.text.slice(d.ch).replace("`","");s.replaceRange(m+h,{line:d.line,ch:0},{line:d.line,ch:99999999999999}),d.ch--,d!==g&&g.ch--,s.setSelection(d,g),s.focus()}else if("fenced"===p)if(d.line!==g.line||d.ch!==g.ch){for(n=d.line;n>=0&&!i(u=s.getLineHandle(n));n--);var f,v,b,y,E=o(s.getTokenAt({line:n,ch:1})).fencedChars;i(s.getLineHandle(d.line))?(f="",v=d.line):i(s.getLineHandle(d.line-1))?(f="",v=d.line-1):(f=E+"\n",v=d.line),i(s.getLineHandle(g.line))?(b="",y=g.line,0===g.ch&&(y+=1)):0!==g.ch&&i(s.getLineHandle(g.line+1))?(b="",y=g.line+1):(b=E+"\n",y=g.line+1),0===g.ch&&(y-=1),s.operation((function(){s.replaceRange(b,{line:y,ch:0},{line:y+(b?0:1),ch:0}),s.replaceRange(f,{line:v,ch:0},{line:v+(f?0:1),ch:0})})),s.setSelection({line:v+(f?1:0),ch:0},{line:y+(f?1:-1),ch:0}),s.focus()}else{var w=d.line;if(i(s.getLineHandle(d.line))&&("fenced"===a(s,d.line+1)?(n=d.line,w=d.line+1):(r=d.line,w=d.line-1)),void 0===n)for(n=w;n>=0&&!i(u=s.getLineHandle(n));n--);if(void 0===r)for(l=s.lineCount(),r=w;r<l&&!i(u=s.getLineHandle(r));r++);s.operation((function(){s.replaceRange("",{line:n,ch:0},{line:n+1,ch:0}),s.replaceRange("",{line:r-1,ch:0},{line:r,ch:0})})),s.focus()}else if("indented"===p){if(d.line!==g.line||d.ch!==g.ch)n=d.line,r=g.line,0===g.ch&&r--;else{for(n=d.line;n>=0;n--)if(!(u=s.getLineHandle(n)).text.match(/^\s*$/)&&"indented"!==a(s,n,u)){n+=1;break}for(l=s.lineCount(),r=d.line;r<l;r++)if(!(u=s.getLineHandle(r)).text.match(/^\s*$/)&&"indented"!==a(s,r,u)){r-=1;break}}var S=s.getLineHandle(r+1),C=S&&s.getTokenAt({line:r+1,ch:S.text.length-1});C&&o(C).indentedCode&&s.replaceRange("\n",{line:r+1,ch:0});for(var M=n;M<=r;M++)s.indentLine(M,"subtract");s.focus()}else{var k=d.line===g.line&&d.ch===g.ch&&0===d.ch,H=d.line!==g.line;k||H?function(e,t,i,o){var a=t.line+1,n=i.line+1,r=t.line!==i.line,l=o+"\n",s="\n"+o;r&&n++,r&&0===i.ch&&(s=o+"\n",n--),_replaceSelection(e,!1,[l,s]),e.setSelection({line:a,ch:0},{line:n,ch:0})}(s,d,g,t):_replaceSelection(s,!1,["`","`"])}}function toggleBlockquote(e){_toggleLine(e.codemirror,"quote")}function toggleHeadingSmaller(e){_toggleHeading(e.codemirror,"smaller")}function toggleHeadingBigger(e){_toggleHeading(e.codemirror,"bigger")}function toggleHeading1(e){_toggleHeading(e.codemirror,void 0,1)}function toggleHeading2(e){_toggleHeading(e.codemirror,void 0,2)}function toggleHeading3(e){_toggleHeading(e.codemirror,void 0,3)}function toggleHeading4(e){_toggleHeading(e.codemirror,void 0,4)}function toggleHeading5(e){_toggleHeading(e.codemirror,void 0,5)}function toggleHeading6(e){_toggleHeading(e.codemirror,void 0,6)}function toggleUnorderedList(e){var t=e.codemirror,i="*";["-","+","*"].includes(e.options.unorderedListStyle)&&(i=e.options.unorderedListStyle),_toggleLine(t,"unordered-list",i)}function toggleOrderedList(e){_toggleLine(e.codemirror,"ordered-list")}function cleanBlock(e){_cleanBlock(e.codemirror)}function drawLink(e){var t=e.options,i="https://";if(t.promptURLs){var o=prompt(t.promptTexts.link,i);if(!o)return!1;i=escapePromptURL(o)}_toggleLink(e,"link",t.insertTexts.link,i)}function drawImage(e){var t=e.options,i="https://";if(t.promptURLs){var o=prompt(t.promptTexts.image,i);if(!o)return!1;i=escapePromptURL(o)}_toggleLink(e,"image",t.insertTexts.image,i)}function escapePromptURL(e){return encodeURI(e).replace(/([\\()])/g,"\\$1")}function drawUploadedImage(e){e.openBrowseFileWindow()}function afterImageUploaded(e,t){var i=e.codemirror,o=getState(i),a=e.options,n=t.substr(t.lastIndexOf("/")+1),r=n.substring(n.lastIndexOf(".")+1).replace(/\?.*$/,"").toLowerCase();if(["png","jpg","jpeg","gif","svg","apng","avif","webp"].includes(r))_replaceSelection(i,o.image,a.insertTexts.uploadedImage,t);else{var l=a.insertTexts.link;l[0]="["+n,_replaceSelection(i,o.link,l,t)}e.updateStatusBar("upload-image",e.options.imageTexts.sbOnUploaded.replace("#image_name#",n)),setTimeout((function(){e.updateStatusBar("upload-image",e.options.imageTexts.sbInit)}),1e3)}function drawTable(e){var t=e.codemirror,i=getState(t),o=e.options;_replaceSelection(t,i.table,o.insertTexts.table)}function drawHorizontalRule(e){var t=e.codemirror,i=getState(t),o=e.options;_replaceSelection(t,i.image,o.insertTexts.horizontalRule)}function undo(e){var t=e.codemirror;t.undo(),t.focus()}function redo(e){var t=e.codemirror;t.redo(),t.focus()}function toggleSideBySide(e){var t=e.codemirror,i=t.getWrapperElement(),o=i.nextSibling,a=e.toolbarElements&&e.toolbarElements["side-by-side"],n=!1,r=i.parentNode;o.classList.contains("editor-preview-active-side")?(!1===e.options.sideBySideFullscreen&&r.classList.remove("sided--no-fullscreen"),o.classList.remove("editor-preview-active-side"),a&&a.classList.remove("active"),i.classList.remove("CodeMirror-sided")):(setTimeout((function(){t.getOption("fullScreen")||(!1===e.options.sideBySideFullscreen?r.classList.add("sided--no-fullscreen"):toggleFullScreen(e)),o.classList.add("editor-preview-active-side")}),1),a&&a.classList.add("active"),i.classList.add("CodeMirror-sided"),n=!0);var l=i.lastChild;if(l.classList.contains("editor-preview-active")){l.classList.remove("editor-preview-active");var s=e.toolbarElements.preview,d=e.toolbar_div;s.classList.remove("active"),d.classList.remove("disabled-for-preview")}if(t.sideBySideRenderingFunction||(t.sideBySideRenderingFunction=function(){var t=e.options.previewRender(e.value(),o);null!=t&&(o.innerHTML=t)}),n){var g=e.options.previewRender(e.value(),o);null!=g&&(o.innerHTML=g),t.on("update",t.sideBySideRenderingFunction)}else t.off("update",t.sideBySideRenderingFunction);t.refresh()}function togglePreview(e){var t=e.codemirror,i=t.getWrapperElement(),o=e.toolbar_div,a=!!e.options.toolbar&&e.toolbarElements.preview,n=i.lastChild;if(t.getWrapperElement().nextSibling.classList.contains("editor-preview-active-side")&&toggleSideBySide(e),!n||!n.classList.contains("editor-preview-full")){if((n=document.createElement("div")).className="editor-preview-full",e.options.previewClass)if(Array.isArray(e.options.previewClass))for(var r=0;r<e.options.previewClass.length;r++)n.classList.add(e.options.previewClass[r]);else"string"==typeof e.options.previewClass&&n.classList.add(e.options.previewClass);i.appendChild(n)}n.classList.contains("editor-preview-active")?(n.classList.remove("editor-preview-active"),a&&(a.classList.remove("active"),o.classList.remove("disabled-for-preview"))):(setTimeout((function(){n.classList.add("editor-preview-active")}),1),a&&(a.classList.add("active"),o.classList.add("disabled-for-preview")));var l=e.options.previewRender(e.value(),n);null!==l&&(n.innerHTML=l)}function _replaceSelection(e,t,i,o){if(!e.getWrapperElement().lastChild.classList.contains("editor-preview-active")){var a,n=i[0],r=i[1],l={},s={};Object.assign(l,e.getCursor("start")),Object.assign(s,e.getCursor("end")),o&&(n=n.replace("#url#",o),r=r.replace("#url#",o)),t?(n=(a=e.getLine(l.line)).slice(0,l.ch),r=a.slice(l.ch),e.replaceRange(n+r,{line:l.line,ch:0})):(a=e.getSelection(),e.replaceSelection(n+a+r),l.ch+=n.length,l!==s&&(s.ch+=n.length)),e.setSelection(l,s),e.focus()}}function _toggleHeading(e,t,i){if(!e.getWrapperElement().lastChild.classList.contains("editor-preview-active")){for(var o=e.getCursor("start"),a=e.getCursor("end"),n=o.line;n<=a.line;n++)!function(o){var a=e.getLine(o),n=a.search(/[^#]/);a=void 0!==t?n<=0?"bigger"==t?"###### "+a:"# "+a:6==n&&"smaller"==t?a.substr(7):1==n&&"bigger"==t?a.substr(2):"bigger"==t?a.substr(1):"#"+a:n<=0?"#".repeat(i)+" "+a:n==i?a.substr(n+1):"#".repeat(i)+" "+a.substr(n+1),e.replaceRange(a,{line:o,ch:0},{line:o,ch:99999999999999})}(n);e.focus()}}function _toggleLine(e,t,i){if(!e.getWrapperElement().lastChild.classList.contains("editor-preview-active")){for(var o=/^(\s*)(\*|-|\+|\d*\.)(\s+)/,a=/^\s*/,n=getState(e),r=e.getCursor("start"),l=e.getCursor("end"),s={quote:/^(\s*)>\s+/,"unordered-list":o,"ordered-list":o},d=function(e,t,n){var r=o.exec(t),l=function(e,t){return{quote:">","unordered-list":i,"ordered-list":"%%i."}[e].replace("%%i",t)}(e,g);return null!==r?(function(e,t){var o=new RegExp({quote:">","unordered-list":"\\"+i,"ordered-list":"\\d+."}[e]);return t&&o.test(t)}(e,r[2])&&(l=""),t=r[1]+l+r[3]+t.replace(a,"").replace(s[e],"$1")):0==n&&(t=l+" "+t),t},g=1,c=r.line;c<=l.line;c++)!function(i){var o=e.getLine(i);n[t]?o=o.replace(s[t],"$1"):("unordered-list"==t&&(o=d("ordered-list",o,!0)),o=d(t,o,!1),g+=1),e.replaceRange(o,{line:i,ch:0},{line:i,ch:99999999999999})}(c);e.focus()}}function _toggleLink(e,t,i,o){if(e.codemirror&&!e.isPreviewActive()){var a=e.codemirror,n=getState(a)[t];if(n){var r=a.getCursor("start"),l=a.getCursor("end"),s=a.getLine(r.line),d=s.slice(0,r.ch),g=s.slice(r.ch);"link"==t?d=d.replace(/(.*)[^!]\[/,"$1"):"image"==t&&(d=d.replace(/(.*)!\[$/,"$1")),g=g.replace(/]\(.*?\)/,""),a.replaceRange(d+g,{line:r.line,ch:0},{line:r.line,ch:99999999999999}),r.ch-=i[0].length,r!==l&&(l.ch-=i[0].length),a.setSelection(r,l),a.focus()}else _replaceSelection(a,n,i,o)}}function _toggleBlock(e,t,i,o){if(e.codemirror&&!e.isPreviewActive()){o=void 0===o?i:o;var a,n=e.codemirror,r=getState(n),l=i,s=o,d=n.getCursor("start"),g=n.getCursor("end");r[t]?(l=(a=n.getLine(d.line)).slice(0,d.ch),s=a.slice(d.ch),"bold"==t?(l=l.replace(/(\*\*|__)(?![\s\S]*(\*\*|__))/,""),s=s.replace(/(\*\*|__)/,"")):"italic"==t?(l=l.replace(/(\*|_)(?![\s\S]*(\*|_))/,""),s=s.replace(/(\*|_)/,"")):"strikethrough"==t&&(l=l.replace(/(\*\*|~~)(?![\s\S]*(\*\*|~~))/,""),s=s.replace(/(\*\*|~~)/,"")),n.replaceRange(l+s,{line:d.line,ch:0},{line:d.line,ch:99999999999999}),"bold"==t||"strikethrough"==t?(d.ch-=2,d!==g&&(g.ch-=2)):"italic"==t&&(d.ch-=1,d!==g&&(g.ch-=1))):(a=n.getSelection(),"bold"==t?a=(a=a.split("**").join("")).split("__").join(""):"italic"==t?a=(a=a.split("*").join("")).split("_").join(""):"strikethrough"==t&&(a=a.split("~~").join("")),n.replaceSelection(l+a+s),d.ch+=i.length,g.ch=d.ch+a.length),n.setSelection(d,g),n.focus()}}function _cleanBlock(e){if(!e.getWrapperElement().lastChild.classList.contains("editor-preview-active"))for(var t,i=e.getCursor("start"),o=e.getCursor("end"),a=i.line;a<=o.line;a++)t=(t=e.getLine(a)).replace(/^[ ]*([# ]+|\*|-|[> ]+|[0-9]+(.|\)))[ ]*/,""),e.replaceRange(t,{line:a,ch:0},{line:a,ch:99999999999999})}function humanFileSize(e,t){if(Math.abs(e)<1024)return""+e+t[0];var i=0;do{e/=1024,++i}while(Math.abs(e)>=1024&&i<t.length);return""+e.toFixed(1)+t[i]}function _mergeProperties(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(t[i]instanceof Array?e[i]=t[i].concat(e[i]instanceof Array?e[i]:[]):null!==t[i]&&"object"==typeof t[i]&&t[i].constructor===Object?e[i]=_mergeProperties(e[i]||{},t[i]):e[i]=t[i]);return e}function extend(e){for(var t=1;t<arguments.length;t++)e=_mergeProperties(e,arguments[t]);return e}function wordCount(e){var t=e.match(/[a-zA-Z0-9_\u00A0-\u02AF\u0392-\u03c9\u0410-\u04F9]+|[\u4E00-\u9FFF\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g),i=0;if(null===t)return i;for(var o=0;o<t.length;o++)t[o].charCodeAt(0)>=19968?i+=t[o].length:i+=1;return i}var iconClassMap={bold:"bi bi-type-bold",italic:"bi bi-type-italic",strikethrough:"bi bi-type-strikethrough",heading:"bi bi-h-square","heading-smaller":"bi bi-h-square","heading-bigger":"bi bi-h-square","heading-1":"bi bi-type-h1","heading-2":"bi bi-type-h2","heading-3":"bi bi-type-h3",code:"bi bi-code",quote:"bi bi-quote","ordered-list":"bi bi-list-ol","unordered-list":"bi bi-list-ul","clean-block":"bi bi-eraser-fill",link:"bi bi-link-45deg",image:"bi bi-image","upload-image":"bi bi-image",table:"bi bi-table","horizontal-rule":"bi bi-hr",preview:"bi bi-eye-fill","side-by-side":"bi bi-layout-split",fullscreen:"bi bi-arrows-fullscreen",guide:"bi bi-question-circle",undo:"bi bi-arrow-counterclockwise",redo:"bi bi-arrow-clockwise"},toolbarBuiltInButtons={bold:{name:"bold",action:toggleBold,className:iconClassMap.bold,title:"Bold",default:!0},italic:{name:"italic",action:toggleItalic,className:iconClassMap.italic,title:"Italic",default:!0},strikethrough:{name:"strikethrough",action:toggleStrikethrough,className:iconClassMap.strikethrough,title:"Strikethrough"},heading:{name:"heading",action:toggleHeadingSmaller,className:iconClassMap.heading,title:"Heading",default:!0},"heading-smaller":{name:"heading-smaller",action:toggleHeadingSmaller,className:iconClassMap["heading-smaller"],title:"Smaller Heading"},"heading-bigger":{name:"heading-bigger",action:toggleHeadingBigger,className:iconClassMap["heading-bigger"],title:"Bigger Heading"},"heading-1":{name:"heading-1",action:toggleHeading1,className:iconClassMap["heading-1"],title:"Big Heading"},"heading-2":{name:"heading-2",action:toggleHeading2,className:iconClassMap["heading-2"],title:"Medium Heading"},"heading-3":{name:"heading-3",action:toggleHeading3,className:iconClassMap["heading-3"],title:"Small Heading"},"separator-1":{name:"separator-1"},code:{name:"code",action:toggleCodeBlock,className:iconClassMap.code,title:"Code"},quote:{name:"quote",action:toggleBlockquote,className:iconClassMap.quote,title:"Quote",default:!0},"unordered-list":{name:"unordered-list",action:toggleUnorderedList,className:iconClassMap["unordered-list"],title:"Generic List",default:!0},"ordered-list":{name:"ordered-list",action:toggleOrderedList,className:iconClassMap["ordered-list"],title:"Numbered List",default:!0},"clean-block":{name:"clean-block",action:cleanBlock,className:iconClassMap["clean-block"],title:"Clean block"},"separator-2":{name:"separator-2"},link:{name:"link",action:drawLink,className:iconClassMap.link,title:"Create Link",default:!0},image:{name:"image",action:drawImage,className:iconClassMap.image,title:"Insert Image",default:!0},"upload-image":{name:"upload-image",action:drawUploadedImage,className:iconClassMap["upload-image"],title:"Import an image"},table:{name:"table",action:drawTable,className:iconClassMap.table,title:"Insert Table"},"horizontal-rule":{name:"horizontal-rule",action:drawHorizontalRule,className:iconClassMap["horizontal-rule"],title:"Insert Horizontal Line"},"separator-3":{name:"separator-3"},preview:{name:"preview",action:togglePreview,className:iconClassMap.preview,noDisable:!0,title:"Toggle Preview",default:!0},"side-by-side":{name:"side-by-side",action:toggleSideBySide,className:iconClassMap["side-by-side"],noDisable:!0,noMobile:!0,title:"Toggle Side by Side",default:!0},fullscreen:{name:"fullscreen",action:toggleFullScreen,className:iconClassMap.fullscreen,noDisable:!0,noMobile:!0,title:"Toggle Fullscreen",default:!0},"separator-4":{name:"separator-4"},guide:{name:"guide",action:"https://www.markdownguide.org/basic-syntax/",className:iconClassMap.guide,noDisable:!0,title:"Markdown Guide",default:!0},"separator-5":{name:"separator-5"},undo:{name:"undo",action:undo,className:iconClassMap.undo,noDisable:!0,title:"Undo"},redo:{name:"redo",action:redo,className:iconClassMap.redo,noDisable:!0,title:"Redo"}},insertTexts={link:["[","](#url#)"],image:["![","](#url#)"],uploadedImage:["![](#url#)",""],table:["","\n\n| Column 1 | Column 2 | Column 3 |\n| -------- | -------- | -------- |\n| Text     | Text     | Text     |\n\n"],horizontalRule:["","\n\n-----\n\n"]},promptTexts={link:"URL for the link:",image:"URL of the image:"},timeFormat={locale:"en-US",format:{hour:"2-digit",minute:"2-digit"}},blockStyles={bold:"**",code:"```",italic:"*"},imageTexts={sbInit:"Attach files by drag and dropping or pasting from clipboard.",sbOnDragEnter:"Drop image to upload it.",sbOnDrop:"Uploading image #images_names#...",sbProgress:"Uploading #file_name#: #progress#%",sbOnUploaded:"Uploaded #image_name#",sizeUnits:" B, KB, MB"},errorMessages={noFileGiven:"You must select a file.",typeNotAllowed:"This image type is not allowed.",fileTooLarge:"Image #image_name# is too big (#image_size#).\nMaximum file size is #image_max_size#.",importError:"Something went wrong when uploading the image #image_name#."};function EasyMDE(e){(e=e||{}).parent=this;var t=!0;if(!1===e.autoDownloadBootstrapIcons&&(t=!1),!0!==e.autoDownloadBootstrapIcons)for(var i=document.styleSheets,o=0;o<i.length;o++)i[o].href&&i[o].href.indexOf("//cdn.jsdelivr.net/npm/bootstrap-icons/")>-1&&(t=!1);if(t){var a=document.createElement("link");a.rel="stylesheet",a.href="https://cdn.jsdelivr.net/npm/bootstrap-icons@latest/font/bootstrap-icons.css",document.getElementsByTagName("head")[0].appendChild(a)}if(e.element)this.element=e.element;else if(null===e.element)return void console.log("EasyMDE: Error. No element was found.");if(void 0===e.toolbar)for(var n in e.toolbar=[],toolbarBuiltInButtons)Object.prototype.hasOwnProperty.call(toolbarBuiltInButtons,n)&&(-1!=n.indexOf("separator-")&&e.toolbar.push("|"),(!0===toolbarBuiltInButtons[n].default||e.showIcons&&e.showIcons.constructor===Array&&-1!=e.showIcons.indexOf(n))&&e.toolbar.push(n));if(Object.prototype.hasOwnProperty.call(e,"previewClass")||(e.previewClass="editor-preview"),Object.prototype.hasOwnProperty.call(e,"status")||(e.status=["autosave","lines","words","cursor"],e.uploadImage&&e.status.unshift("upload-image")),e.previewRender||(e.previewRender=function(e){return this.parent.markdown(e)}),e.parsingConfig=extend({highlightFormatting:!0},e.parsingConfig||{}),e.insertTexts=extend({},insertTexts,e.insertTexts||{}),e.promptTexts=extend({},promptTexts,e.promptTexts||{}),e.blockStyles=extend({},blockStyles,e.blockStyles||{}),null!=e.autosave&&(e.autosave.timeFormat=extend({},timeFormat,e.autosave.timeFormat||{})),e.iconClassMap=extend({},iconClassMap,e.iconClassMap||{}),e.shortcuts=extend({},shortcuts,e.shortcuts||{}),e.maxHeight=e.maxHeight||void 0,e.direction=e.direction||"ltr",void 0!==e.maxHeight?e.minHeight=e.maxHeight:e.minHeight=e.minHeight||"300px",e.errorCallback=e.errorCallback||function(e){alert(e)},e.uploadImage=e.uploadImage||!1,e.imageMaxSize=e.imageMaxSize||2097152,e.imageAccept=e.imageAccept||"image/png, image/jpeg, image/gif, image/avif",e.imageTexts=extend({},imageTexts,e.imageTexts||{}),e.errorMessages=extend({},errorMessages,e.errorMessages||{}),e.imagePathAbsolute=e.imagePathAbsolute||!1,e.imageCSRFName=e.imageCSRFName||"csrfmiddlewaretoken",e.imageCSRFHeader=e.imageCSRFHeader||!1,null!=e.autosave&&null!=e.autosave.unique_id&&""!=e.autosave.unique_id&&(e.autosave.uniqueId=e.autosave.unique_id),e.overlayMode&&void 0===e.overlayMode.combine&&(e.overlayMode.combine=!0),this.options=e,this.render(),!e.initialValue||this.options.autosave&&!0===this.options.autosave.foundSavedValue||this.value(e.initialValue),e.uploadImage){var r=this;this.codemirror.on("dragenter",(function(e,t){r.updateStatusBar("upload-image",r.options.imageTexts.sbOnDragEnter),t.stopPropagation(),t.preventDefault()})),this.codemirror.on("dragend",(function(e,t){r.updateStatusBar("upload-image",r.options.imageTexts.sbInit),t.stopPropagation(),t.preventDefault()})),this.codemirror.on("dragleave",(function(e,t){r.updateStatusBar("upload-image",r.options.imageTexts.sbInit),t.stopPropagation(),t.preventDefault()})),this.codemirror.on("dragover",(function(e,t){r.updateStatusBar("upload-image",r.options.imageTexts.sbOnDragEnter),t.stopPropagation(),t.preventDefault()})),this.codemirror.on("drop",(function(t,i){i.stopPropagation(),i.preventDefault(),e.imageUploadFunction?r.uploadImagesUsingCustomFunction(e.imageUploadFunction,i.dataTransfer.files):r.uploadImages(i.dataTransfer.files)})),this.codemirror.on("paste",(function(t,i){e.imageUploadFunction?r.uploadImagesUsingCustomFunction(e.imageUploadFunction,i.clipboardData.files):r.uploadImages(i.clipboardData.files)}))}}function isLocalStorageAvailable(){if("object"!=typeof localStorage)return!1;try{localStorage.setItem("smde_localStorage",1),localStorage.removeItem("smde_localStorage")}catch(e){return!1}return!0}EasyMDE.prototype.uploadImages=function(e,t,i){if(0!==e.length){for(var o=[],a=0;a<e.length;a++)o.push(e[a].name),this.uploadImage(e[a],t,i);this.updateStatusBar("upload-image",this.options.imageTexts.sbOnDrop.replace("#images_names#",o.join(", ")))}},EasyMDE.prototype.uploadImagesUsingCustomFunction=function(e,t){if(0!==t.length){for(var i=[],o=0;o<t.length;o++)i.push(t[o].name),this.uploadImageUsingCustomFunction(e,t[o]);this.updateStatusBar("upload-image",this.options.imageTexts.sbOnDrop.replace("#images_names#",i.join(", ")))}},EasyMDE.prototype.updateStatusBar=function(e,t){if(this.gui.statusbar){var i=this.gui.statusbar.getElementsByClassName(e);1===i.length?this.gui.statusbar.getElementsByClassName(e)[0].textContent=t:0===i.length?console.log("EasyMDE: status bar item "+e+" was not found."):console.log("EasyMDE: Several status bar items named "+e+" was found.")}},EasyMDE.prototype.markdown=function(e){if(marked){var t;if(t=this.options&&this.options.renderingConfig&&this.options.renderingConfig.markedOptions?this.options.renderingConfig.markedOptions:{},this.options&&this.options.renderingConfig&&!1===this.options.renderingConfig.singleLineBreaks?t.breaks=!1:t.breaks=!0,this.options&&this.options.renderingConfig&&!0===this.options.renderingConfig.codeSyntaxHighlighting){var i=this.options.renderingConfig.hljs||window.hljs;i&&(t.highlight=function(e,t){return t&&i.getLanguage(t)?i.highlight(t,e).value:i.highlightAuto(e).value})}marked.setOptions(t);var o=marked.parse(e);return this.options.renderingConfig&&"function"==typeof this.options.renderingConfig.sanitizerFunction&&(o=this.options.renderingConfig.sanitizerFunction.call(this,o)),o=removeListStyleWhenCheckbox(o=addAnchorTargetBlank(o))}},EasyMDE.prototype.render=function(e){if(e||(e=this.element||document.getElementsByTagName("textarea")[0]),!this._rendered||this._rendered!==e){this.element=e;var t,i,o=this.options,a=this,n={};for(var r in o.shortcuts)null!==o.shortcuts[r]&&null!==bindings[r]&&function(e){n[fixShortcut(o.shortcuts[e])]=function(){var t=bindings[e];"function"==typeof t?t(a):"string"==typeof t&&window.open(t,"_blank")}}(r);if(n.Enter="newlineAndIndentContinueMarkdownList",n.Tab="tabAndIndentMarkdownList",n["Shift-Tab"]="shiftTabAndUnindentMarkdownList",n.Esc=function(e){e.getOption("fullScreen")&&toggleFullScreen(a)},this.documentOnKeyDown=function(e){27==(e=e||window.event).keyCode&&a.codemirror.getOption("fullScreen")&&toggleFullScreen(a)},document.addEventListener("keydown",this.documentOnKeyDown,!1),o.overlayMode?(CodeMirror.defineMode("overlay-mode",(function(e){return CodeMirror.overlayMode(CodeMirror.getMode(e,!1!==o.spellChecker?"spell-checker":"gfm"),o.overlayMode.mode,o.overlayMode.combine)})),t="overlay-mode",(i=o.parsingConfig).gitHubSpice=!1):((t=o.parsingConfig).name="gfm",t.gitHubSpice=!1),!1!==o.spellChecker&&(t="spell-checker",(i=o.parsingConfig).name="gfm",i.gitHubSpice=!1,"function"==typeof o.spellChecker?o.spellChecker({codeMirrorInstance:CodeMirror}):CodeMirrorSpellChecker({codeMirrorInstance:CodeMirror})),this.codemirror=CodeMirror.fromTextArea(e,{mode:t,backdrop:i,theme:null!=o.theme?o.theme:"easymde",tabSize:null!=o.tabSize?o.tabSize:2,indentUnit:null!=o.tabSize?o.tabSize:2,indentWithTabs:!1!==o.indentWithTabs,lineNumbers:!0===o.lineNumbers,autofocus:!0===o.autofocus,extraKeys:n,direction:o.direction,lineWrapping:!1!==o.lineWrapping,allowDropFileTypes:["text/plain"],placeholder:o.placeholder||e.getAttribute("placeholder")||"",styleSelectedText:null!=o.styleSelectedText?o.styleSelectedText:!isMobile(),scrollbarStyle:null!=o.scrollbarStyle?o.scrollbarStyle:"native",configureMouse:function(e,t,i){return{addNew:!1}},inputStyle:null!=o.inputStyle?o.inputStyle:isMobile()?"contenteditable":"textarea",spellcheck:null==o.nativeSpellcheck||o.nativeSpellcheck,autoRefresh:null!=o.autoRefresh&&o.autoRefresh}),this.codemirror.getScrollerElement().style.minHeight=o.minHeight,void 0!==o.maxHeight&&(this.codemirror.getScrollerElement().style.height=o.maxHeight),!0===o.forceSync){var l=this.codemirror;l.on("change",(function(){l.save()}))}this.gui={};var s=document.createElement("div");s.classList.add("EasyMDEContainer"),s.setAttribute("role","application");var d=this.codemirror.getWrapperElement();d.parentNode.insertBefore(s,d),s.appendChild(d),!1!==o.toolbar&&(this.gui.toolbar=this.createToolbar()),!1!==o.status&&(this.gui.statusbar=this.createStatusbar()),null!=o.autosave&&!0===o.autosave.enabled&&(this.autosave(),this.codemirror.on("change",(function(){clearTimeout(a._autosave_timeout),a._autosave_timeout=setTimeout((function(){a.autosave()}),a.options.autosave.submit_delay||a.options.autosave.delay||1e3)})));var g=this;this.codemirror.on("update",(function(){o.previewImagesInEditor&&s.querySelectorAll(".cm-image-marker").forEach((function(e){var t=e.parentElement;if(t.innerText.match(/^!\[.*?\]\(.*\)/g)&&!t.hasAttribute("data-img-src")){var i=t.innerText.match("\\((.*)\\)");if(window.EMDEimagesCache||(window.EMDEimagesCache={}),i&&i.length>=2){var a=i[1];if(o.imagesPreviewHandler){var n=o.imagesPreviewHandler(i[1]);"string"==typeof n&&(a=n)}if(window.EMDEimagesCache[a])u(t,window.EMDEimagesCache[a]);else{var r=document.createElement("img");r.onload=function(){window.EMDEimagesCache[a]={naturalWidth:r.naturalWidth,naturalHeight:r.naturalHeight,url:a},u(t,window.EMDEimagesCache[a])},r.src=a}}}}))})),this.gui.sideBySide=this.createSideBySide(),this._rendered=this.element,(!0===o.autofocus||e.autofocus)&&this.codemirror.focus();var c=this.codemirror;setTimeout(function(){c.refresh()}.bind(c),0)}function u(e,t){var i,o;e.setAttribute("data-img-src",t.url),e.setAttribute("style","--bg-image:url("+t.url+");--width:"+t.naturalWidth+"px;--height:"+(i=t.naturalWidth,o=t.naturalHeight,i<window.getComputedStyle(document.querySelector(".CodeMirror-sizer")).width.replace("px","")?o+"px":o/i*100+"%")),g.codemirror.setSize()}},EasyMDE.prototype.cleanup=function(){document.removeEventListener("keydown",this.documentOnKeyDown)},EasyMDE.prototype.autosave=function(){if(isLocalStorageAvailable()){var e=this;if(null==this.options.autosave.uniqueId||""==this.options.autosave.uniqueId)return void console.log("EasyMDE: You must set a uniqueId to use the autosave feature");!0!==this.options.autosave.binded&&(null!=e.element.form&&null!=e.element.form&&e.element.form.addEventListener("submit",(function(){clearTimeout(e.autosaveTimeoutId),e.autosaveTimeoutId=void 0,localStorage.removeItem("smde_"+e.options.autosave.uniqueId)})),this.options.autosave.binded=!0),!0!==this.options.autosave.loaded&&("string"==typeof localStorage.getItem("smde_"+this.options.autosave.uniqueId)&&""!=localStorage.getItem("smde_"+this.options.autosave.uniqueId)&&(this.codemirror.setValue(localStorage.getItem("smde_"+this.options.autosave.uniqueId)),this.options.autosave.foundSavedValue=!0),this.options.autosave.loaded=!0);var t=e.value();""!==t?localStorage.setItem("smde_"+this.options.autosave.uniqueId,t):localStorage.removeItem("smde_"+this.options.autosave.uniqueId);var i=document.getElementById("autosaved");if(null!=i&&null!=i&&""!=i){var o=new Date,a=new Intl.DateTimeFormat([this.options.autosave.timeFormat.locale,"en-US"],this.options.autosave.timeFormat.format).format(o),n=null==this.options.autosave.text?"Autosaved: ":this.options.autosave.text;i.innerHTML=n+a}}else console.log("EasyMDE: localStorage not available, cannot autosave")},EasyMDE.prototype.clearAutosavedValue=function(){if(isLocalStorageAvailable()){if(null==this.options.autosave||null==this.options.autosave.uniqueId||""==this.options.autosave.uniqueId)return void console.log("EasyMDE: You must set a uniqueId to clear the autosave value");localStorage.removeItem("smde_"+this.options.autosave.uniqueId)}else console.log("EasyMDE: localStorage not available, cannot autosave")},EasyMDE.prototype.openBrowseFileWindow=function(e,t){var i=this,o=this.gui.toolbar.getElementsByClassName("imageInput")[0];o.click(),o.addEventListener("change",(function a(n){i.options.imageUploadFunction?i.uploadImagesUsingCustomFunction(i.options.imageUploadFunction,n.target.files):i.uploadImages(n.target.files,e,t),o.removeEventListener("change",a)}))},EasyMDE.prototype.uploadImage=function(e,t,i){var o=this;function a(e){o.updateStatusBar("upload-image",e),setTimeout((function(){o.updateStatusBar("upload-image",o.options.imageTexts.sbInit)}),1e4),i&&"function"==typeof i&&i(e),o.options.errorCallback(e)}function n(t){var i=o.options.imageTexts.sizeUnits.split(",");return t.replace("#image_name#",e.name).replace("#image_size#",humanFileSize(e.size,i)).replace("#image_max_size#",humanFileSize(o.options.imageMaxSize,i))}if(t=t||function(e){afterImageUploaded(o,e)},e.size>this.options.imageMaxSize)a(n(this.options.errorMessages.fileTooLarge));else{var r=new FormData;r.append("image",e),o.options.imageCSRFToken&&!o.options.imageCSRFHeader&&r.append(o.options.imageCSRFName,o.options.imageCSRFToken);var l=new XMLHttpRequest;l.upload.onprogress=function(t){if(t.lengthComputable){var i=""+Math.round(100*t.loaded/t.total);o.updateStatusBar("upload-image",o.options.imageTexts.sbProgress.replace("#file_name#",e.name).replace("#progress#",i))}},l.open("POST",this.options.imageUploadEndpoint),o.options.imageCSRFToken&&o.options.imageCSRFHeader&&l.setRequestHeader(o.options.imageCSRFName,o.options.imageCSRFToken),l.onload=function(){try{var e=JSON.parse(this.responseText)}catch(e){return console.error("EasyMDE: The server did not return a valid json."),void a(n(o.options.errorMessages.importError))}200===this.status&&e&&!e.error&&e.data&&e.data.filePath?t((o.options.imagePathAbsolute?"":window.location.origin+"/")+e.data.filePath):e.error&&e.error in o.options.errorMessages?a(n(o.options.errorMessages[e.error])):e.error?a(n(e.error)):(console.error("EasyMDE: Received an unexpected response after uploading the image."+this.status+" ("+this.statusText+")"),a(n(o.options.errorMessages.importError)))},l.onerror=function(e){console.error("EasyMDE: An unexpected error occurred when trying to upload the image."+e.target.status+" ("+e.target.statusText+")"),a(o.options.errorMessages.importError)},l.send(r)}},EasyMDE.prototype.uploadImageUsingCustomFunction=function(e,t){var i=this;e.apply(this,[t,function(e){afterImageUploaded(i,e)},function(e){var o=function(e){var o=i.options.imageTexts.sizeUnits.split(",");return e.replace("#image_name#",t.name).replace("#image_size#",humanFileSize(t.size,o)).replace("#image_max_size#",humanFileSize(i.options.imageMaxSize,o))}(e);i.updateStatusBar("upload-image",o),setTimeout((function(){i.updateStatusBar("upload-image",i.options.imageTexts.sbInit)}),1e4),i.options.errorCallback(o)}])},EasyMDE.prototype.setPreviewMaxHeight=function(){var e=this.codemirror.getWrapperElement(),t=e.nextSibling,i=parseInt(window.getComputedStyle(e).paddingTop),o=parseInt(window.getComputedStyle(e).borderTopWidth),a=(parseInt(this.options.maxHeight)+2*i+2*o).toString()+"px";t.style.height=a},EasyMDE.prototype.createSideBySide=function(){var e=this.codemirror,t=e.getWrapperElement(),i=t.nextSibling;if(!i||!i.classList.contains("editor-preview-side")){if((i=document.createElement("div")).className="editor-preview-side",this.options.previewClass)if(Array.isArray(this.options.previewClass))for(var o=0;o<this.options.previewClass.length;o++)i.classList.add(this.options.previewClass[o]);else"string"==typeof this.options.previewClass&&i.classList.add(this.options.previewClass);t.parentNode.insertBefore(i,t.nextSibling)}if(void 0!==this.options.maxHeight&&this.setPreviewMaxHeight(),!1===this.options.syncSideBySidePreviewScroll)return i;var a=!1,n=!1;return e.on("scroll",(function(e){if(a)a=!1;else{n=!0;var t=e.getScrollInfo().height-e.getScrollInfo().clientHeight,o=parseFloat(e.getScrollInfo().top)/t,r=(i.scrollHeight-i.clientHeight)*o;i.scrollTop=r}})),i.onscroll=function(){if(n)n=!1;else{a=!0;var t=i.scrollHeight-i.clientHeight,o=parseFloat(i.scrollTop)/t,r=(e.getScrollInfo().height-e.getScrollInfo().clientHeight)*o;e.scrollTo(0,r)}},i},EasyMDE.prototype.createToolbar=function(e){if((e=e||this.options.toolbar)&&0!==e.length){var t;for(t=0;t<e.length;t++)null!=toolbarBuiltInButtons[e[t]]&&(e[t]=toolbarBuiltInButtons[e[t]]);var i=document.createElement("div");i.className="editor-toolbar",i.setAttribute("role","toolbar");var o=this,a={};for(o.toolbar=e,t=0;t<e.length;t++)if(("guide"!=e[t].name||!1!==o.options.toolbarGuideIcon)&&!(o.options.hideIcons&&-1!=o.options.hideIcons.indexOf(e[t].name)||("fullscreen"==e[t].name||"side-by-side"==e[t].name)&&isMobile())){if("|"===e[t]){for(var n=!1,r=t+1;r<e.length;r++)"|"===e[r]||o.options.hideIcons&&-1!=o.options.hideIcons.indexOf(e[r].name)||(n=!0);if(!n)continue}!function(e){var t;if(t="|"===e?createSep():e.children?createToolbarDropdown(e,o.options.toolbarTips,o.options.shortcuts,o):createToolbarButton(e,!0,o.options.toolbarTips,o.options.shortcuts,"button",o),a[e.name||e]=t,i.appendChild(t),"upload-image"===e.name){var n=document.createElement("input");n.className="imageInput",n.type="file",n.multiple=!0,n.name="image",n.accept=o.options.imageAccept,n.style.display="none",n.style.opacity=0,i.appendChild(n)}}(e[t])}o.toolbar_div=i,o.toolbarElements=a;var l=this.codemirror;l.on("cursorActivity",(function(){var e=getState(l);for(var t in a)!function(t){var i=a[t];e[t]?i.classList.add("active"):"fullscreen"!=t&&"side-by-side"!=t&&i.classList.remove("active")}(t)}));var s=l.getWrapperElement();return s.parentNode.insertBefore(i,s),i}},EasyMDE.prototype.createStatusbar=function(e){e=e||this.options.status;var t=this.options,i=this.codemirror;if(e&&0!==e.length){var o,a,n,r,l=[];for(o=0;o<e.length;o++)if(a=void 0,n=void 0,r=void 0,"object"==typeof e[o])l.push({className:e[o].className,defaultValue:e[o].defaultValue,onUpdate:e[o].onUpdate,onActivity:e[o].onActivity});else{var s=e[o];"words"===s?(r=function(e){e.innerHTML=wordCount(i.getValue())},a=function(e){e.innerHTML=wordCount(i.getValue())}):"lines"===s?(r=function(e){e.innerHTML=i.lineCount()},a=function(e){e.innerHTML=i.lineCount()}):"cursor"===s?(r=function(e){e.innerHTML="1:1"},n=function(e){var t=i.getCursor(),o=t.line+1,a=t.ch+1;e.innerHTML=o+":"+a}):"autosave"===s?r=function(e){null!=t.autosave&&!0===t.autosave.enabled&&e.setAttribute("id","autosaved")}:"upload-image"===s&&(r=function(e){e.innerHTML=t.imageTexts.sbInit}),l.push({className:s,defaultValue:r,onUpdate:a,onActivity:n})}var d=document.createElement("div");for(d.className="editor-statusbar",o=0;o<l.length;o++){var g=l[o],c=document.createElement("span");c.className=g.className,"function"==typeof g.defaultValue&&g.defaultValue(c),"function"==typeof g.onUpdate&&this.codemirror.on("update",function(e,t){return function(){t.onUpdate(e)}}(c,g)),"function"==typeof g.onActivity&&this.codemirror.on("cursorActivity",function(e,t){return function(){t.onActivity(e)}}(c,g)),d.appendChild(c)}var u=this.codemirror.getWrapperElement();return u.parentNode.insertBefore(d,u.nextSibling),d}},EasyMDE.prototype.value=function(e){var t=this.codemirror;if(void 0===e)return t.getValue();if(t.getDoc().setValue(e),this.isPreviewActive()){var i=t.getWrapperElement().lastChild,o=this.options.previewRender(e,i);null!==o&&(i.innerHTML=o)}return this},EasyMDE.toggleBold=toggleBold,EasyMDE.toggleItalic=toggleItalic,EasyMDE.toggleStrikethrough=toggleStrikethrough,EasyMDE.toggleBlockquote=toggleBlockquote,EasyMDE.toggleHeadingSmaller=toggleHeadingSmaller,EasyMDE.toggleHeadingBigger=toggleHeadingBigger,EasyMDE.toggleHeading1=toggleHeading1,EasyMDE.toggleHeading2=toggleHeading2,EasyMDE.toggleHeading3=toggleHeading3,EasyMDE.toggleHeading4=toggleHeading4,EasyMDE.toggleHeading5=toggleHeading5,EasyMDE.toggleHeading6=toggleHeading6,EasyMDE.toggleCodeBlock=toggleCodeBlock,EasyMDE.toggleUnorderedList=toggleUnorderedList,EasyMDE.toggleOrderedList=toggleOrderedList,EasyMDE.cleanBlock=cleanBlock,EasyMDE.drawLink=drawLink,EasyMDE.drawImage=drawImage,EasyMDE.drawUploadedImage=drawUploadedImage,EasyMDE.drawTable=drawTable,EasyMDE.drawHorizontalRule=drawHorizontalRule,EasyMDE.undo=undo,EasyMDE.redo=redo,EasyMDE.togglePreview=togglePreview,EasyMDE.toggleSideBySide=toggleSideBySide,EasyMDE.toggleFullScreen=toggleFullScreen,EasyMDE.prototype.toggleBold=function(){toggleBold(this)},EasyMDE.prototype.toggleItalic=function(){toggleItalic(this)},EasyMDE.prototype.toggleStrikethrough=function(){toggleStrikethrough(this)},EasyMDE.prototype.toggleBlockquote=function(){toggleBlockquote(this)},EasyMDE.prototype.toggleHeadingSmaller=function(){toggleHeadingSmaller(this)},EasyMDE.prototype.toggleHeadingBigger=function(){toggleHeadingBigger(this)},EasyMDE.prototype.toggleHeading1=function(){toggleHeading1(this)},EasyMDE.prototype.toggleHeading2=function(){toggleHeading2(this)},EasyMDE.prototype.toggleHeading3=function(){toggleHeading3(this)},EasyMDE.prototype.toggleHeading4=function(){toggleHeading4(this)},EasyMDE.prototype.toggleHeading5=function(){toggleHeading5(this)},EasyMDE.prototype.toggleHeading6=function(){toggleHeading6(this)},EasyMDE.prototype.toggleCodeBlock=function(){toggleCodeBlock(this)},EasyMDE.prototype.toggleUnorderedList=function(){toggleUnorderedList(this)},EasyMDE.prototype.toggleOrderedList=function(){toggleOrderedList(this)},EasyMDE.prototype.cleanBlock=function(){cleanBlock(this)},EasyMDE.prototype.drawLink=function(){drawLink(this)},EasyMDE.prototype.drawImage=function(){drawImage(this)},EasyMDE.prototype.drawUploadedImage=function(){drawUploadedImage(this)},EasyMDE.prototype.drawTable=function(){drawTable(this)},EasyMDE.prototype.drawHorizontalRule=function(){drawHorizontalRule(this)},EasyMDE.prototype.undo=function(){undo(this)},EasyMDE.prototype.redo=function(){redo(this)},EasyMDE.prototype.togglePreview=function(){togglePreview(this)},EasyMDE.prototype.toggleSideBySide=function(){toggleSideBySide(this)},EasyMDE.prototype.toggleFullScreen=function(){toggleFullScreen(this)},EasyMDE.prototype.isPreviewActive=function(){return this.codemirror.getWrapperElement().lastChild.classList.contains("editor-preview-active")},EasyMDE.prototype.isSideBySideActive=function(){return this.codemirror.getWrapperElement().nextSibling.classList.contains("editor-preview-active-side")},EasyMDE.prototype.isFullscreenActive=function(){return this.codemirror.getOption("fullScreen")},EasyMDE.prototype.getState=function(){return getState(this.codemirror)},EasyMDE.prototype.toTextArea=function(){var e=this.codemirror,t=e.getWrapperElement(),i=t.parentNode;i&&(this.gui.toolbar&&i.removeChild(this.gui.toolbar),this.gui.statusbar&&i.removeChild(this.gui.statusbar),this.gui.sideBySide&&i.removeChild(this.gui.sideBySide)),i.parentNode.insertBefore(t,i),i.remove(),e.toTextArea(),this.autosaveTimeoutId&&(clearTimeout(this.autosaveTimeoutId),this.autosaveTimeoutId=void 0,this.clearAutosavedValue())},module.exports=EasyMDE;
//# sourceMappingURL=/sm/5c45c887e1f398488056731978266178f30099d44d266be6ac65a20219cfefd9.map